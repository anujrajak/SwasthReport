{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/anujrajak/Learn/Pathology/patho-client/utils/firestore/reports.ts"],"sourcesContent":["import {\n  collection,\n  doc,\n  getDoc,\n  getDocs,\n  setDoc,\n  deleteDoc,\n  query,\n  orderBy,\n  limit,\n  startAfter,\n  Timestamp,\n  QueryDocumentSnapshot,\n  DocumentData,\n} from \"firebase/firestore\";\nimport { db } from \"../firebase\";\nimport { cleanFirestoreData } from \"./clean-data\";\nimport { getPatients } from \"./patients\";\n\nexport interface TestParameterResult {\n  value: number | string;\n  unit: string;\n  range: string | Record<string, string>;\n}\n\nexport interface TestResult {\n  name: string;\n  category: string;\n  parameters: Record<string, TestParameterResult>;\n}\n\nexport interface TestResults {\n  [testId: string]: TestResult;\n}\n\nexport interface Report {\n  date: Timestamp;\n  doctor: string; // Reference or \"Self\" as default\n  tests: TestResults;\n  comments?: string;\n}\n\nexport interface ReportWithId extends Report {\n  id: string;\n}\n\nexport interface ReportWithPatientInfo extends ReportWithId {\n  patientId: string;\n  patientName: string;\n}\n\n/**\n * Get all reports for a patient\n */\nexport const getReports = async (\n  userId: string,\n  patientId: string\n): Promise<ReportWithId[]> => {\n  const reportsRef = collection(\n    db,\n    \"users\",\n    userId,\n    \"patients\",\n    patientId,\n    \"reports\"\n  );\n  const q = query(reportsRef, orderBy(\"date\", \"desc\"));\n  const querySnapshot = await getDocs(q);\n\n  return querySnapshot.docs.map((doc) => ({\n    id: doc.id,\n    ...(doc.data() as Report),\n  }));\n};\n\n/**\n * Get a single report by ID\n */\nexport const getReport = async (\n  userId: string,\n  patientId: string,\n  reportId: string\n): Promise<ReportWithId | null> => {\n  const reportRef = doc(\n    db,\n    \"users\",\n    userId,\n    \"patients\",\n    patientId,\n    \"reports\",\n    reportId\n  );\n  const reportDoc = await getDoc(reportRef);\n\n  if (!reportDoc.exists()) {\n    return null;\n  }\n\n  return {\n    id: reportDoc.id,\n    ...(reportDoc.data() as Report),\n  };\n};\n\n/**\n * Create a new report\n */\nexport const createReport = async (\n  userId: string,\n  patientId: string,\n  reportData: Omit<Report, \"date\"> & { date?: Date | Timestamp }\n): Promise<string> => {\n  // Convert date to Timestamp if it's a Date\n  const date =\n    reportData.date instanceof Date\n      ? Timestamp.fromDate(reportData.date)\n      : reportData.date || Timestamp.now();\n\n  const dataToSave: Report = {\n    date,\n    doctor: reportData.doctor || \"Self\",\n    tests: reportData.tests,\n    comments: reportData.comments,\n  };\n\n  const cleanedData = cleanFirestoreData(dataToSave, {\n    optionalStringFields: [\"comments\"],\n  });\n\n  const reportsRef = collection(\n    db,\n    \"users\",\n    userId,\n    \"patients\",\n    patientId,\n    \"reports\"\n  );\n  const newReportRef = doc(reportsRef);\n\n  await setDoc(newReportRef, cleanedData);\n\n  return newReportRef.id;\n};\n\n/**\n * Update an existing report\n */\nexport const updateReport = async (\n  userId: string,\n  patientId: string,\n  reportId: string,\n  reportData: Partial<Omit<Report, \"date\">> & { date?: Date | Timestamp }\n): Promise<void> => {\n  const dataToSave: Record<string, unknown> = {};\n\n  // Copy all fields except date\n  if (reportData.doctor !== undefined) {\n    dataToSave.doctor = reportData.doctor;\n  }\n  if (reportData.tests !== undefined) {\n    dataToSave.tests = reportData.tests;\n  }\n  if (reportData.comments !== undefined) {\n    dataToSave.comments = reportData.comments;\n  }\n\n  // Convert date to Timestamp if it's a Date\n  if (reportData.date) {\n    dataToSave.date =\n      reportData.date instanceof Date\n        ? Timestamp.fromDate(reportData.date)\n        : reportData.date;\n  }\n\n  const cleanedData = cleanFirestoreData(dataToSave, {\n    optionalStringFields: [\"comments\"],\n  });\n\n  const reportRef = doc(\n    db,\n    \"users\",\n    userId,\n    \"patients\",\n    patientId,\n    \"reports\",\n    reportId\n  );\n  await setDoc(reportRef, cleanedData, { merge: true });\n};\n\n/**\n * Delete a report\n */\nexport const deleteReport = async (\n  userId: string,\n  patientId: string,\n  reportId: string\n): Promise<void> => {\n  const reportRef = doc(\n    db,\n    \"users\",\n    userId,\n    \"patients\",\n    patientId,\n    \"reports\",\n    reportId\n  );\n  await deleteDoc(reportRef);\n};\n\n/**\n * Get all reports across all patients for a user with pagination\n * Returns reports sorted by date descending\n */\nexport const getAllReports = async (\n  userId: string,\n  pageSize: number = 50,\n  lastReport?: { patientId: string; reportDate: Timestamp; reportId: string }\n): Promise<{\n  reports: ReportWithPatientInfo[];\n  lastReport: { patientId: string; reportDate: Timestamp; reportId: string } | null;\n  hasMore: boolean;\n}> => {\n  // Get all patients - fetch in batches if needed\n  const allPatients: Awaited<ReturnType<typeof getPatients>>[\"patients\"] = [];\n  let lastDoc: QueryDocumentSnapshot<DocumentData> | null = null;\n  let hasMorePatients = true;\n\n  while (hasMorePatients) {\n    const patientsResult = await getPatients(userId, 1000, lastDoc);\n    allPatients.push(...patientsResult.patients);\n    lastDoc = patientsResult.lastDoc;\n    hasMorePatients = patientsResult.hasMore;\n  }\n  \n  console.log(`Fetching reports for ${allPatients.length} patients`);\n\n  // Get all reports from all patients\n  const allReports: ReportWithPatientInfo[] = [];\n\n  for (const patient of allPatients) {\n    try {\n      const reportsRef = collection(\n        db,\n        \"users\",\n        userId,\n        \"patients\",\n        patient.id,\n        \"reports\"\n      );\n      \n      // Try to query with orderBy, but if it fails (no index), query without orderBy\n      let querySnapshot;\n      try {\n        const q = query(reportsRef, orderBy(\"date\", \"desc\"));\n        querySnapshot = await getDocs(q);\n      } catch (error) {\n        // If orderBy fails (likely missing index), fetch without orderBy and sort in memory\n        console.warn(`Failed to query reports with orderBy for patient ${patient.id}, fetching without orderBy:`, error);\n        querySnapshot = await getDocs(reportsRef);\n      }\n\n      querySnapshot.docs.forEach((doc) => {\n        const reportData = doc.data() as Report;\n        // Only add if report has required fields\n        if (reportData.date && reportData.tests) {\n          allReports.push({\n            id: doc.id,\n            patientId: patient.id,\n            patientName: patient.name,\n            ...reportData,\n          });\n        } else {\n          console.warn(`Report ${doc.id} for patient ${patient.id} is missing required fields:`, {\n            hasDate: !!reportData.date,\n            hasTests: !!reportData.tests,\n            data: reportData,\n          });\n        }\n      });\n      \n      if (querySnapshot.docs.length > 0) {\n        console.log(`Found ${querySnapshot.docs.length} reports for patient ${patient.name} (${patient.id})`);\n      }\n    } catch (error) {\n      // Log error but continue with other patients\n      console.error(`Error fetching reports for patient ${patient.id}:`, error);\n    }\n  }\n\n  console.log(`Total reports found across all patients: ${allReports.length}`);\n  \n  // Sort all reports by date descending\n  allReports.sort((a, b) => {\n    const dateA = a.date instanceof Timestamp ? a.date.toMillis() : a.date.getTime();\n    const dateB = b.date instanceof Timestamp ? b.date.toMillis() : b.date.getTime();\n    return dateB - dateA; // Descending order\n  });\n\n  // Implement pagination\n  let startIndex = 0;\n  if (lastReport) {\n    // Find the index of the last report\n    const lastIndex = allReports.findIndex(\n      (r) =>\n        r.patientId === lastReport.patientId &&\n        r.id === lastReport.reportId\n    );\n    if (lastIndex !== -1) {\n      startIndex = lastIndex + 1;\n    }\n  }\n\n  const endIndex = startIndex + pageSize + 1; // Fetch one extra to check for more\n  const paginatedReports = allReports.slice(startIndex, endIndex);\n  const hasMore = paginatedReports.length > pageSize;\n  const reportsToReturn = hasMore ? paginatedReports.slice(0, pageSize) : paginatedReports;\n\n  const lastReportData =\n    reportsToReturn.length > 0\n      ? {\n          patientId: reportsToReturn[reportsToReturn.length - 1].patientId,\n          reportDate: reportsToReturn[reportsToReturn.length - 1].date instanceof Timestamp\n            ? reportsToReturn[reportsToReturn.length - 1].date\n            : Timestamp.fromDate(reportsToReturn[reportsToReturn.length - 1].date),\n          reportId: reportsToReturn[reportsToReturn.length - 1].id,\n        }\n      : null;\n\n  return {\n    reports: reportsToReturn,\n    lastReport: lastReportData,\n    hasMore,\n  };\n};\n\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 184, "column": 0}, "map": {"version":3,"sources":["file:///Users/anujrajak/Learn/Pathology/patho-client/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Card({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\n        \"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn(\"leading-none font-semibold\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardDescription({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn(\"text-muted-foreground text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardAction({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-action\"\n      className={cn(\n        \"col-start-2 row-span-2 row-start-1 self-start justify-self-end\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn(\"px-6\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn(\"flex items-center px-6 [.border-t]:pt-6\", className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardAction,\n  CardDescription,\n  CardContent,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,+aAAC;QACC,aAAU;QACV,WAAW,IAAA,kJAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,+aAAC;QACC,aAAU;QACV,WAAW,IAAA,kJAAE,EACX,4JACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,+aAAC;QACC,aAAU;QACV,WAAW,IAAA,kJAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,+aAAC;QACC,aAAU;QACV,WAAW,IAAA,kJAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,+aAAC;QACC,aAAU;QACV,WAAW,IAAA,kJAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,+aAAC;QACC,aAAU;QACV,WAAW,IAAA,kJAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,+aAAC;QACC,aAAU;QACV,WAAW,IAAA,kJAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 286, "column": 0}, "map": {"version":3,"sources":["file:///Users/anujrajak/Learn/Pathology/patho-client/app/dashboard/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { getPatients } from \"@/utils/firestore/patients\";\nimport { getAllReports } from \"@/utils/firestore/reports\";\nimport { useEffect, useState } from \"react\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Users, FileText, Activity, TrendingUp } from \"lucide-react\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\n\nexport default function DashboardPage() {\n  const { user: firebaseUser } = useAuth();\n  const [stats, setStats] = useState({\n    patients: 0,\n    reports: 0,\n    loading: true,\n  });\n\n  useEffect(() => {\n    if (!firebaseUser?.uid) {\n      setStats({ patients: 0, reports: 0, loading: false });\n      return;\n    }\n\n    const fetchStats = async () => {\n      try {\n        const [patientsResult, reportsResult] = await Promise.all([\n          getPatients(firebaseUser.uid, 10000),\n          getAllReports(firebaseUser.uid, 1),\n        ]);\n        setStats({\n          patients: patientsResult.patients.length,\n          reports: reportsResult.reports.length + (reportsResult.hasMore ? 1 : 0),\n          loading: false,\n        });\n      } catch (error) {\n        console.error(\"Failed to fetch stats:\", error);\n        setStats({ patients: 0, reports: 0, loading: false });\n      }\n    };\n\n    fetchStats();\n  }, [firebaseUser?.uid]);\n\n  if (stats.loading) {\n    return (\n      <div className=\"grid auto-rows-min gap-4 md:grid-cols-3\">\n        <Skeleton className=\"aspect-video rounded-xl\" />\n        <Skeleton className=\"aspect-video rounded-xl\" />\n        <Skeleton className=\"aspect-video rounded-xl\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div>\n        <h1 className=\"text-3xl font-bold tracking-tight bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent\">\n          Dashboard\n        </h1>\n        <p className=\"text-muted-foreground mt-2\">\n          Welcome back! Here's an overview of your lab\n        </p>\n      </div>\n\n      <div className=\"grid auto-rows-min gap-4 md:grid-cols-3\">\n        <Card className=\"border-0 bg-gradient-to-br from-blue-500 to-blue-600 text-white shadow-lg hover:shadow-xl transition-shadow\">\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium text-blue-50\">\n              Total Patients\n            </CardTitle>\n            <div className=\"h-8 w-8 rounded-full bg-blue-400/20 flex items-center justify-center\">\n              <Users className=\"h-5 w-5 text-blue-100\" />\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-3xl font-bold text-white\">{stats.patients}</div>\n            <p className=\"text-xs text-blue-100 mt-1\">\n              Active patient records\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card className=\"border-0 bg-gradient-to-br from-purple-500 to-purple-600 text-white shadow-lg hover:shadow-xl transition-shadow\">\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium text-purple-50\">\n              Total Reports\n            </CardTitle>\n            <div className=\"h-8 w-8 rounded-full bg-purple-400/20 flex items-center justify-center\">\n              <FileText className=\"h-5 w-5 text-purple-100\" />\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-3xl font-bold text-white\">{stats.reports}</div>\n            <p className=\"text-xs text-purple-100 mt-1\">\n              Pathology reports created\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card className=\"border-0 bg-gradient-to-br from-emerald-500 to-emerald-600 text-white shadow-lg hover:shadow-xl transition-shadow\">\n          <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n            <CardTitle className=\"text-sm font-medium text-emerald-50\">\n              Lab Activity\n            </CardTitle>\n            <div className=\"h-8 w-8 rounded-full bg-emerald-400/20 flex items-center justify-center\">\n              <Activity className=\"h-5 w-5 text-emerald-100\" />\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-3xl font-bold text-white\">\n              {stats.reports > 0 ? \"Active\" : \"Ready\"}\n            </div>\n            <p className=\"text-xs text-emerald-100 mt-1\">\n              {stats.reports > 0 ? \"Reports in system\" : \"Start creating reports\"}\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AARA;;;;;;;;;AAUe,SAAS;IACtB,MAAM,EAAE,MAAM,YAAY,EAAE,GAAG,IAAA,2JAAO;IACtC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,kZAAQ,EAAC;QACjC,UAAU;QACV,SAAS;QACT,SAAS;IACX;IAEA,IAAA,mZAAS,EAAC;QACR,IAAI,CAAC,cAAc,KAAK;YACtB,SAAS;gBAAE,UAAU;gBAAG,SAAS;gBAAG,SAAS;YAAM;YACnD;QACF;QAEA,MAAM,aAAa;YACjB,IAAI;gBACF,MAAM,CAAC,gBAAgB,cAAc,GAAG,MAAM,QAAQ,GAAG,CAAC;oBACxD,IAAA,6KAAW,EAAC,aAAa,GAAG,EAAE;oBAC9B,IAAA,8KAAa,EAAC,aAAa,GAAG,EAAE;iBACjC;gBACD,SAAS;oBACP,UAAU,eAAe,QAAQ,CAAC,MAAM;oBACxC,SAAS,cAAc,OAAO,CAAC,MAAM,GAAG,CAAC,cAAc,OAAO,GAAG,IAAI,CAAC;oBACtE,SAAS;gBACX;YACF,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,0BAA0B;gBACxC,SAAS;oBAAE,UAAU;oBAAG,SAAS;oBAAG,SAAS;gBAAM;YACrD;QACF;QAEA;IACF,GAAG;QAAC,cAAc;KAAI;IAEtB,IAAI,MAAM,OAAO,EAAE;QACjB,qBACE,+aAAC;YAAI,WAAU;;8BACb,+aAAC,yKAAQ;oBAAC,WAAU;;;;;;8BACpB,+aAAC,yKAAQ;oBAAC,WAAU;;;;;;8BACpB,+aAAC,yKAAQ;oBAAC,WAAU;;;;;;;;;;;;IAG1B;IAEA,qBACE,+aAAC;QAAI,WAAU;;0BACb,+aAAC;;kCACC,+aAAC;wBAAG,WAAU;kCAA+G;;;;;;kCAG7H,+aAAC;wBAAE,WAAU;kCAA6B;;;;;;;;;;;;0BAK5C,+aAAC;gBAAI,WAAU;;kCACb,+aAAC,iKAAI;wBAAC,WAAU;;0CACd,+aAAC,uKAAU;gCAAC,WAAU;;kDACpB,+aAAC,sKAAS;wCAAC,WAAU;kDAAmC;;;;;;kDAGxD,+aAAC;wCAAI,WAAU;kDACb,cAAA,+aAAC,iUAAK;4CAAC,WAAU;;;;;;;;;;;;;;;;;0CAGrB,+aAAC,wKAAW;;kDACV,+aAAC;wCAAI,WAAU;kDAAiC,MAAM,QAAQ;;;;;;kDAC9D,+aAAC;wCAAE,WAAU;kDAA6B;;;;;;;;;;;;;;;;;;kCAM9C,+aAAC,iKAAI;wBAAC,WAAU;;0CACd,+aAAC,uKAAU;gCAAC,WAAU;;kDACpB,+aAAC,sKAAS;wCAAC,WAAU;kDAAqC;;;;;;kDAG1D,+aAAC;wCAAI,WAAU;kDACb,cAAA,+aAAC,8UAAQ;4CAAC,WAAU;;;;;;;;;;;;;;;;;0CAGxB,+aAAC,wKAAW;;kDACV,+aAAC;wCAAI,WAAU;kDAAiC,MAAM,OAAO;;;;;;kDAC7D,+aAAC;wCAAE,WAAU;kDAA+B;;;;;;;;;;;;;;;;;;kCAMhD,+aAAC,iKAAI;wBAAC,WAAU;;0CACd,+aAAC,uKAAU;gCAAC,WAAU;;kDACpB,+aAAC,sKAAS;wCAAC,WAAU;kDAAsC;;;;;;kDAG3D,+aAAC;wCAAI,WAAU;kDACb,cAAA,+aAAC,0UAAQ;4CAAC,WAAU;;;;;;;;;;;;;;;;;0CAGxB,+aAAC,wKAAW;;kDACV,+aAAC;wCAAI,WAAU;kDACZ,MAAM,OAAO,GAAG,IAAI,WAAW;;;;;;kDAElC,+aAAC;wCAAE,WAAU;kDACV,MAAM,OAAO,GAAG,IAAI,sBAAsB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOzD"}},
    {"offset": {"line": 620, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/Pathology/patho-client/node_modules/.pnpm/lucide-react@0.555.0_react@19.2.0/node_modules/lucide-react/dist/esm/icons/activity.js","sources":["file:///Users/anujrajak/Learn/Pathology/patho-client/node_modules/.pnpm/lucide-react%400.555.0_react%4019.2.0/node_modules/lucide-react/src/icons/activity.ts"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  [\n    'path',\n    {\n      d: 'M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2',\n      key: '169zse',\n    },\n  ],\n];\n\n/**\n * @component @name Activity\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjIgMTJoLTIuNDhhMiAyIDAgMCAwLTEuOTMgMS40NmwtMi4zNSA4LjM2YS4yNS4yNSAwIDAgMS0uNDggMEw5LjI0IDIuMThhLjI1LjI1IDAgMCAwLS40OCAwbC0yLjM1IDguMzZBMiAyIDAgMCAxIDQuNDkgMTJIMiIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/activity\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Activity = createLucideIcon('activity', __iconNode);\n\nexport default Activity;\n"],"names":[],"mappings":";;;;;;;;;;;;;AAGO,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,UAAA,CAAA,CAAA,CAAuB;IAClC;QACE,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QACA;YACE,CAAA,EAAG,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;YACH,GAAA,CAAA,CAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA;QAAA;KACP;CAEJ;AAaA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAM,QAAA,CAAA,CAAA,KAAW,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,kRAAA,EAAiB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EAAY,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAU,CAAA"}}]
}